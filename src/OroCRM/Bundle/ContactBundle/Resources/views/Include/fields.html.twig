{% block oro_contact_widget %}
    {# // check if block was not included yet #}
    {% set _block = block('orocrm_contactphone_updater_js') %}
    {% if (_block is empty) %}
        {% include 'OroCRMContactBundle:Include:javascript.html.twig' %}
        {{ block('orocrm_contactphone_updater_js')|raw }}
    {% endif %}

    {% if contact_field is not defined or contact_field is empty %}
        {% set contact_field = "#" ~ id|replace({'_contact_phone': '_contact'}) %}
    {% endif %}

    {% if contact_phone_text_field is not defined or contact_phone_text_field is empty %}
        {% set contact_phone_text_field = "#" ~ id ~ "_text" %}
    {% endif %}

    {{ form_widget(form) }}

    <script type="text/javascript">
        require(['jquery', 'orocrm/contactphone/view', 'orocrm/contactphone/collection'],
        function($, ContactPhoneView, ContactPhoneViewCollection){
            $(function() {
                new ContactPhoneViewView({
                    el: $('{{ contact }}'),
                    target: $('#{{ id }}'),
                    simpleEl: $('{{ phoneNumber }}'),
                    collection: new ContactPhoneViewCollection(),
                    showSelect: {{ (choices is not empty)|json_encode }}
                });
            });
        });
    </script>

    <style type="text/css">
        {% if choices %}
            #{{ id }} {
                display: block;
            }

            {{ contact_phone_text_field }} {
                display: none;
            }
        {% else %}
            #{{ id }} {
                display: none;
            }

            {{ contact_phone_text_field }} {
                display: block;
            }
        {% endif %}
    </style>
{% endblock oro_contact_widget %}
