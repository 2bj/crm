{% import 'OroUIBundle::macros.html.twig' as UI %}

{% if resource_granted('oro_email_create') %}
    {% if entity.extendEmail is defined and entity.extendEmail is not empty %}
        {% set title = 'oro.email.send_email'|trans %}
        {{ UI.dropdownClientButton({
            'dataUrl': path('oro_email_email_create', { 'to': entity.extendEmail }) ,
            'aCss': 'no-hash',
            'iCss': 'icon-envelope',
            'dataId': entity.defaultContact.id,
            'title' : title,
            'label' : title,
            'widget' : {
                'type' : 'dialog',
                'multiple' : true,
                'gridName' : 'account-email-grid',
                'options' : {
                    'alias': 'email-dialog',
                    'dialogOptions' : {
                        'title' : title,
                        'allowMaximize': true,
                        'allowMinimize': true,
                        'dblclick': 'maximize',
                        'maximizedHeightDecreaseBy': 'minimize-bar',
                        'width': 1000
                    }
                }
            },
        }) }}
    {% endif %}
{% endif %}
